# Attempting to remove "noise" of Okazaki Fragments

The GLOE-seq paper focused on the analysis of Okazaki fragments and their
ability to map these fragments as compared to other previous methods. I am
currently interested in the "spontaneous" breaks they detected and their
association to R-loops. 

In their pipeline they use `macs2` to call beaks between test and control
samples. Notably there is a human cell line with Ligase-1 knocked out via
siRNA silencing. Ligase-1 is responsible for sealing the nicks between
Okazaki fragments and therefore comparing to a control cell line should
reveal positions of Okazaki fragments. 

In my case we actually want to throw out these fragments and retain the
non-Okazaki reads. This would in theory leave SSBs that are not a result of
DNA replication and include spontaneous breaks which would be more appropriate to
look at in relation to R-loop formation sites.  

## Strategy

My approach here was to do break calling using Macs2 using parameters lifted
from the [GLOE-Pipe program](https://gitlab.com/GPetrosino/GLOE-Pipe/-/blob/master/modules/GLOEseq/macs2.module.groovy)
and then use `bedtools intersect -v` to remove called breaks from the treatment
sample. 

This would leave a bed file for the treatment sample devoid of breaks that
were called due to the differences with the control after treatment with
ligase-1. 

## Initial results / thoughts


`output/GSM4305466/reorient_alignments/direct/rev/seperated.all.bed`
, the output from mapping reads without calling peaks yet, was intersected with 
`output/call_peaks/GSM4305466.vs.GSM3939125_macs2/direct/all/rev/macs2_peak_call_summits.bed`
which was the output of calling peaks using sample `GSM4305466` (ligase 1 treated)
with the control `GSM3939125` (no treatment). This intersection only preserved
the reads in `output/GSM4305466/reorient_alignments/direct/rev/seperated.all.bed`
that *did not* overlap with reads in 
`output/call_peaks/GSM4305466.vs.GSM3939125_macs2/direct/all/rev/macs2_peak_call_summits.bed`. In other words, the result of this operation
should have removed all the SSBs in the treatment that were called due
to differences to the control.

### Examining the files

`cat output/GSM4305466/reorient_alignments/direct/rev/seperated.all.bed | wc -l`
reveals the file to have a total of 104,783,006 lines (reads).
The MACS2 summits file has 1,074,860 lines. The intersected file
contains 71,698,663. 

This means ~30,000,000 reads where removed from the original mapped
reads but left the vast majority. This is only for one sample
and for one strand but I was expecting this drop to be *much* larger
than that. Possibly around > 60% of the reads as the present result would
seem to indicate that most of these breaks are not in fact Okazaki
fragments. 

This needs some further investigation and visualization which I am
working on further today. Maybe with some kind of flow diagram?

Also need to correct the spelling of 'seperated'.

### Thoughts on read depth

Now realizing that the input file being compared to the break calling
is not filtered for read depth leaving "breaks" with as few as single
reads in the dataset. I should use a file that throws out these reads as
the input and see what the proportions looks like then to see
if these low count breaks are driving lack of loss.



